// **********************************************************
// Fuzzing example - simplest possible buffer overflow
//
// Copyright 2020
// Charles Lucas
// ZeroSquared.io
// **********************************************************


#include <iostream>
#include <cstring>

int main(int argc, char* argv[]) {
    char input[6];  // Allocate space for six characters plus the null

    if (argc < 2) {
        std::cout << "Enter at least one input string on the command line.\n";
        exit(0);
    }

    // Print out all the command-line arguments
    //std::cout << "There were " << argc << " command-line arguments passed in:" << std::endl;
    //for (int i = 0; i < argc; ++i) {
    //    std::cout << argv[i] << std::endl;
    //}

    // Blindly copy the passed-in string into our fixed-width variable.
    // If the passed-in string is more than six characters, the program should crash
    //   before we see the output printed below.
    strcpy(input, argv[1]);  // Crash here

    std::cout << "String received:  " << input << std::endl;
}